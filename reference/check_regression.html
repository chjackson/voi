<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Produces diagnostic plots and summaries of regression models used to estimate EVPPI or EVSI,
mainly in order to check that the residuals have mean zero."><title>Check the fit of a regression model used to estimate EVPPI or EVSI — check_regression • voi</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Check the fit of a regression model used to estimate EVPPI or EVSI — check_regression"><meta property="og:description" content="Produces diagnostic plots and summaries of regression models used to estimate EVPPI or EVSI,
mainly in order to check that the residuals have mean zero."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">voi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/voi.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/book.html">Value of Information for Health Economic Evaluations: book code resources</a>
    <a class="dropdown-item" href="../articles/plots.html">Plots of Value of Information measures</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/chjackson/voi/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Check the fit of a regression model used to estimate EVPPI or EVSI</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/voi/blob/HEAD/R/check_regression.R" class="external-link"><code>R/check_regression.R</code></a></small>
      <div class="d-none name"><code>check_regression.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Produces diagnostic plots and summaries of regression models used to estimate EVPPI or EVSI,
mainly in order to check that the residuals have mean zero.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">check_regression</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  comparison <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"costs"</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Output from <code><a href="evppi.html">evppi</a></code> or <code><a href="evsi.html">evsi</a></code>. The argument <code>check=TRUE</code>
must have been used when calling <code>evppi</code> or <code>evsi</code>, to allow the regression model
objects from <code>gam</code> or <code>earth</code> to be preserved.  (This is not done by
default, since these objects can be large.).   <code>attr(x, "models")</code> cont</p></dd>


<dt>pars</dt>
<dd><p>Parameter (or parameter group) whose EVPPI calculation is to be checked.
This should be in the <code>pars</code> component of the object returned by <code><a href="evppi.html">evppi</a></code>.
Only relevant if <code>x</code> is the result of an <code><a href="evppi.html">evppi</a></code> calculation.  By default,
the first calculation shown in <code>x</code> is checked.</p></dd>


<dt>n</dt>
<dd><p>Sample size whose EVSI calculation is to be checked.
This should be in the <code>n</code> component of the object returned by <code><a href="evsi.html">evsi</a></code>.
Only relevant if <code>x</code> is the result of an <code><a href="evsi.html">evsi</a></code> calculation.</p></dd>


<dt>comparison</dt>
<dd><p>Only relevant if there are more than two treatments in the decision model.
Different regression models are then used for the comparisons of different treatments
with the baseline treatment.
<code>comparison</code> is an integer identifying which of these models is checked.</p></dd>


<dt>outcome</dt>
<dd><p><code>"costs"</code> or <code>"effects"</code>.  Only relevant if <code>outputs</code> was
in cost-effectiveness format when
calling <code>evppi</code> or <code>evsi</code>, hence different regressions are used for costs and
effects.  By default, <code>outcome="costs"</code> is used, so that the regression
for costs is checked.</p></dd>


<dt>plot</dt>
<dd><p>If <code>FALSE</code>, only numerical statistics are returned, and a plot is not made.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Where possible, an appropriate statistic is returned that allows the regression
model to be compared with other regression models implemented using the same <code>method</code></p>


<p>but with different assumptions.   For <code>method="gam"</code>,
this is Akaike's information criterion (AIC).
For <code>method="earth"</code>, this is the generalised cross-validation statistic
<code>gcv</code>.    Currently not implemented for other methods.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For VoI estimation, the key thing we are looking for is that the residuals
have mean zero, hence that the mean of the model output is represented well by the
regression function of the model input parameters.  It should not matter if the
variance of the residuals is non-constant, or non-normally distributed.</p>
<p>Models produced with <code>method="gam"</code> are summarised using <code>gam.check</code>.</p>
<p>Models produced <code>method="earth"</code> are summarised using <code>plot.earth</code>.</p>
<p>For any regression model, if <code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted()</a></code> and <code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals()</a></code> methods are defined for those models,
then a histogram of the residuals and a scatterplot of residuals against fitted values is produced.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_side_effects_t1"</span>, <span class="st">"p_side_effects_t2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">evtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="evppi.html">evppi</a></span><span class="op">(</span><span class="va">chemo_nb</span>, <span class="va">chemo_pars</span>, pars<span class="op">=</span><span class="va">pars</span>, check<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">evtest</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  pars    evppi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 p_side_effects_t1,p_side_effects_t2 333.4516</span>
<span class="r-in"><span><span class="fu">check_regression</span><span class="op">(</span><span class="va">evtest</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="check_regression-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $AIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 149411.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## with no interaction term </span></span></span>
<span class="r-in"><span><span class="va">evtest2</span> <span class="op">&lt;-</span> <span class="fu"><a href="evppi.html">evppi</a></span><span class="op">(</span><span class="va">chemo_nb</span>, <span class="va">chemo_pars</span>, pars<span class="op">=</span><span class="va">pars</span>, </span></span>
<span class="r-in"><span>                gam_formula<span class="op">=</span><span class="st">"s(p_side_effects_t1)+s(p_side_effects_t2)"</span>,</span></span>
<span class="r-in"><span>                check<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">evtest2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  pars   evppi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 p_side_effects_t1,p_side_effects_t2 334.059</span>
<span class="r-in"><span><span class="fu">check_regression</span><span class="op">(</span><span class="va">evtest2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="check_regression-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $AIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 149408.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## doesn't make much difference to the estimate</span></span></span>
<span class="r-in"><span><span class="co">## fit is OK in either case</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

